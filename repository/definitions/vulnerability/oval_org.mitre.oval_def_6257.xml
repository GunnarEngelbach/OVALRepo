<oval-def:definition xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:6257" version="11">
  <oval-def:metadata>
    <oval-def:title>Windows Media Header Parsing Invalid Free Vulnerability</oval-def:title>
    <oval-def:affected family="windows">
      <oval-def:platform>Microsoft Windows 2000</oval-def:platform>
      <oval-def:platform>Microsoft Windows XP</oval-def:platform>
      <oval-def:platform>Microsoft Windows Server 2003</oval-def:platform>
      <oval-def:platform>Microsoft Windows Vista</oval-def:platform>
      <oval-def:platform>Microsoft Windows Server 2008</oval-def:platform>
      <oval-def:product>Windows Media Format Runtime 9.0</oval-def:product>
      <oval-def:product>Windows Media Format Runtime 9.5</oval-def:product>
      <oval-def:product>Windows Media Format Runtime 11</oval-def:product>
      <oval-def:product>Microsoft Media Services 9.1</oval-def:product>
      <oval-def:product>Microsoft Media Services 9</oval-def:product>
    </oval-def:affected>
    <oval-def:reference ref_id="CVE-2009-2498" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2498" source="CVE" />
    <oval-def:description>Microsoft Windows Media Format Runtime 9.0, 9.5, and 11 and Windows Media Services 9.1 and 2008 do not properly parse malformed headers in Advanced Systems Format (ASF) files, which allows remote attackers to execute arbitrary code via a crafted (1) .asf, (2) .wmv, or (3) .wma file, aka "Windows Media Header Parsing Invalid Free Vulnerability."</oval-def:description>
    <oval-def:oval_repository>
      <oval-def:dates>
        <oval-def:submitted date="2009-09-08T13:00:00">
          <oval-def:contributor organization="Gideon Technologies, Inc.">Dragos Prisaca</oval-def:contributor>
        </oval-def:submitted>
        <oval-def:status_change date="2009-09-12T20:28:11.654-04:00">DRAFT</oval-def:status_change>
        <oval-def:status_change date="2009-09-28T04:00:18.458-04:00">INTERIM</oval-def:status_change>
        <oval-def:modified comment="Updated oval:org.mitre.oval:obj:7139 to refer to oval:org.mitre.oval:var:202 rather than the deprecated oval:org.mitre.oval:var:207" date="2009-09-30T20:14:00.930-04:00">
          <oval-def:contributor organization="Gideon Technologies, Inc.">Dragos Prisaca</oval-def:contributor>
        </oval-def:modified>
        <oval-def:status_change date="2009-10-19T04:00:12.210-04:00">ACCEPTED</oval-def:status_change>
        <oval-def:modified comment="Corrected comment for var:202 to refer to environment variable" date="2009-12-01T17:28:00.093-05:00">
          <oval-def:contributor organization="Gideon Technologies, Inc.">Dragos Prisaca</oval-def:contributor>
        </oval-def:modified>
        <oval-def:status_change date="2009-12-01T17:32:23.746-05:00">INTERIM</oval-def:status_change>
        <oval-def:status_change date="2009-12-21T04:00:50.985-05:00">ACCEPTED</oval-def:status_change>
        <oval-def:modified comment="EDITED oval:org.mitre.oval:def:6257 - def:6257, - Added LDR version check for Windows Media Format 11. - tst:10615 is replaced by new test, as it was pointing to wrong file.  def:5531, - Removed non-vuln Windows Media Services from product tag. - Added LDR version check for Windows Media Format 11. - tst:10615 is replaced by new test, as it was pointing to wrong file." date="2011-10-27T10:12:00.272-04:00">
          <oval-def:contributor organization="SecPod Technologies">Rachana Shetty</oval-def:contributor>
        </oval-def:modified>
        <oval-def:status_change date="2011-10-27T10:15:54.569-04:00">INTERIM</oval-def:status_change>
        <oval-def:status_change date="2011-11-14T04:01:00.178-05:00">ACCEPTED</oval-def:status_change>
        <oval-def:modified comment="EDITED oval:org.mitre.oval:def:6257 - modified comments" date="2014-02-28T15:13:00.247-05:00">
          <oval-def:contributor organization="ALTX-SOFT">Maria Mikhno</oval-def:contributor>
        </oval-def:modified>
        <oval-def:status_change date="2014-02-28T15:16:17.693-05:00">INTERIM</oval-def:status_change>
        <oval-def:status_change date="2014-03-17T04:00:26.163-04:00">ACCEPTED</oval-def:status_change>
        <oval-def:modified comment="EDITED oval:org.mitre.oval:def:6257 - extended definitions of OS are without SP checks" date="2014-07-28T17:41:00.906-04:00">
          <oval-def:contributor organization="ALTX-SOFT">Maria Mikhno</oval-def:contributor>
        </oval-def:modified>
        <oval-def:status_change date="2014-07-28T17:42:50.731-04:00">INTERIM</oval-def:status_change>
        <oval-def:status_change date="2014-08-18T04:06:10.141-04:00">ACCEPTED</oval-def:status_change>
        <oval-def:modified comment="EDITED oval:org.mitre.oval:def:6257 - Modified vulnerabilities - a lot of fixes" date="2015-07-22T13:32:00.926-04:00">
          <oval-def:contributor organization="ALTX-SOFT">Maria Mikhno</oval-def:contributor>
        </oval-def:modified>
        <oval-def:status_change date="2015-07-22T13:35:53.634-04:00">INTERIM</oval-def:status_change>
        <oval-def:status_change date="2015-08-10T04:01:03.985-04:00">ACCEPTED</oval-def:status_change>
      </oval-def:dates>
      <oval-def:status>ACCEPTED</oval-def:status>
      <oval-def:min_schema_version>5.6</oval-def:min_schema_version>
    </oval-def:oval_repository>
  </oval-def:metadata>
  <oval-def:criteria operator="OR">
    <oval-def:criteria comment="Windows Media Format Runtime 9.0 on Windows 2000 and Windows XP" operator="AND">
      <oval-def:criteria comment="OS Check" operator="OR">
        <oval-def:extend_definition comment="Microsoft Windows 2000 is installed" definition_ref="oval:org.mitre.oval:def:85" />
        <oval-def:extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353" />
      </oval-def:criteria>
      <oval-def:extend_definition comment="Windows Media Format Runtime 9.0 is installed" definition_ref="oval:org.mitre.oval:def:29023" />
      <oval-def:criterion comment="Wmvcore.dll for Windows Media Format 9.0 is installed." test_ref="oval:org.mitre.oval:tst:125" />
      <oval-def:criterion comment="the version of Wmvcore.dll is less than 9.0.0.3270" test_ref="oval:org.mitre.oval:tst:10770" />
    </oval-def:criteria>
    <oval-def:criteria comment="Windows Media Format Runtime 9.0 on Windows XP (x86)" operator="AND">
      <oval-def:extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353" />
      <oval-def:extend_definition comment="Windows Media Format Runtime 9.0 is installed" definition_ref="oval:org.mitre.oval:def:29023" />
      <oval-def:criterion comment="Wmvcore.dll for Windows Media Format 9.0 is installed." test_ref="oval:org.mitre.oval:tst:125" />
      <oval-def:criterion comment="the version of Wmvcore.dll is less than 9.0.0.4506" test_ref="oval:org.mitre.oval:tst:10757" />
    </oval-def:criteria>
    <oval-def:criteria comment="Windows Media Format Runtime 9.5 on Windows XP (x86)" operator="AND">
      <oval-def:extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353" />
      <oval-def:extend_definition comment="Windows Media Format Runtime 9.5 is installed" definition_ref="oval:org.mitre.oval:def:28835" />
      <oval-def:criterion comment="Wmvcore.dll for Windows Media Format 9.5 is installed." test_ref="oval:org.mitre.oval:tst:115" />
      <oval-def:criterion comment="the version of Wmvcore.dll is less than 10.0.0.3705" test_ref="oval:org.mitre.oval:tst:10702" />
    </oval-def:criteria>
    <oval-def:criteria comment="Windows Media Format Runtime 11 on Windows XP (x86)" operator="AND">
      <oval-def:extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353" />
      <oval-def:extend_definition comment="Windows Media Format Runtime 11 is installed" definition_ref="oval:org.mitre.oval:def:28129" />
      <oval-def:criterion comment="Wmvcore.dll for Windows Media Format 11.0 is installed." test_ref="oval:org.mitre.oval:tst:6765" />
      <oval-def:criterion comment="the version of Wmvcore.dll is less than 11.0.5721.5265" test_ref="oval:org.mitre.oval:tst:10594" />
    </oval-def:criteria>
    <oval-def:criteria comment="Windows Media Format Runtime 9.5 on Windows XP x64 ans Windows 2003 x64" operator="AND">
      <oval-def:criteria comment="OS Check" operator="OR">
        <oval-def:extend_definition comment="Microsoft Windows XP x64 is installed" definition_ref="oval:org.mitre.oval:def:15247" />
        <oval-def:extend_definition comment="Microsoft Windows Server 2003 (x64) is installed" definition_ref="oval:org.mitre.oval:def:730" />
      </oval-def:criteria>
      <oval-def:extend_definition comment="Windows Media Format Runtime 9.5 is installed" definition_ref="oval:org.mitre.oval:def:28835" />
      <oval-def:criterion comment="Wmvcore.dll for Windows Media Format 9.5 on x64-bit platform is installed." test_ref="oval:org.mitre.oval:tst:10154" />
      <oval-def:criterion comment="the version of %SystemRoot%\SysWOW64\Wmvcore.dll is less than 10.0.0.4005" test_ref="oval:org.mitre.oval:tst:10673" />
    </oval-def:criteria>
    <oval-def:criteria comment="Windows Media Format Runtime 11 on Windows XP x64" operator="AND">
      <oval-def:extend_definition comment="Microsoft Windows XP x64 is installed" definition_ref="oval:org.mitre.oval:def:15247" />
      <oval-def:extend_definition comment="Windows Media Format Runtime 11 is installed" definition_ref="oval:org.mitre.oval:def:28129" />
      <oval-def:criterion comment="Wmvcore.dll for Windows Media Format 11.0 on x64-bit platform is installed." test_ref="oval:org.mitre.oval:tst:10083" />
      <oval-def:criterion comment="the version of %SystemRoot%\SysWOW64\Wmvcore.dll is less than 11.0.5721.5265" test_ref="oval:org.mitre.oval:tst:10402" />
    </oval-def:criteria>
    <oval-def:criteria comment="Windows Media Format Runtime 9.5 on Windows Server 2003 x86" operator="AND">
      <oval-def:extend_definition comment="Microsoft Windows Server 2003 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1870" />
      <oval-def:extend_definition comment="Windows Media Format Runtime 9.5 is installed" definition_ref="oval:org.mitre.oval:def:28835" />
      <oval-def:criterion comment="Wmvcore.dll for Windows Media Format 9.5 is installed." test_ref="oval:org.mitre.oval:tst:115" />
      <oval-def:criterion comment="the version of Wmvcore.dll is less than 10.0.0.4005" test_ref="oval:org.mitre.oval:tst:10704" />
    </oval-def:criteria>
    <oval-def:criteria comment="Windows Media Format Runtime 11 on Windows Vista x86/x64" operator="AND">
      <oval-def:criteria comment="OS Check" operator="OR">
        <oval-def:extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282" />
        <oval-def:extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041" />
      </oval-def:criteria>
      <oval-def:extend_definition comment="Windows Media Format Runtime 11 is installed" definition_ref="oval:org.mitre.oval:def:28129" />
      <oval-def:criterion comment="Wmvcore.dll for Windows Media Format 11.0 is installed." test_ref="oval:org.mitre.oval:tst:6765" />
      <oval-def:criterion comment="the version of Wmvcore.dll is less than 11.0.5721.5265" test_ref="oval:org.mitre.oval:tst:10337" />
    </oval-def:criteria>
    <oval-def:criteria comment="Windows Media Format Runtime 11 on Windows Vista x86/x64, Windows Server 2008 x86/x64" operator="AND">
      <oval-def:criteria comment="OS Check" operator="OR">
        <oval-def:extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282" />
        <oval-def:extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041" />
        <oval-def:extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
        <oval-def:extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
      </oval-def:criteria>
      <oval-def:extend_definition comment="Windows Media Format Runtime 11 is installed" definition_ref="oval:org.mitre.oval:def:28129" />
      <oval-def:criterion comment="Wmvcore.dll for Windows Media Format 11.0 is installed." test_ref="oval:org.mitre.oval:tst:6765" />
      <oval-def:criterion comment="the version of Wmvcore.dll is less than 11.0.6001.7006" test_ref="oval:org.mitre.oval:tst:10211" />
    </oval-def:criteria>
    <oval-def:criteria comment="Windows Media Format Runtime 11 on Windows Vista x86/x64, Windows Server 2008 x86/x64" operator="AND">
      <oval-def:criteria comment="OS Check" operator="OR">
        <oval-def:extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282" />
        <oval-def:extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041" />
        <oval-def:extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
        <oval-def:extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
      </oval-def:criteria>
      <oval-def:extend_definition comment="Windows Media Format Runtime 11 is installed" definition_ref="oval:org.mitre.oval:def:28129" />
      <oval-def:criterion comment="Wmvcore.dll for Windows Media Format 11.0 is installed." test_ref="oval:org.mitre.oval:tst:6765" />
      <oval-def:criteria comment="GDR or LDR Service branch" operator="OR">
        <oval-def:criterion comment="the version of Wmvcore.dll is less than 11.0.6002.18049" test_ref="oval:org.mitre.oval:tst:44381" />
        <oval-def:criteria comment="LDR" operator="AND">
          <oval-def:criterion comment="the version of Wmvcore.dll is greater than or equal 11.0.6002.22000" test_ref="oval:org.mitre.oval:tst:43500" />
          <oval-def:criterion comment="the version of Wmvcore.dll is less than 11.0.6002.22150" test_ref="oval:org.mitre.oval:tst:44186" />
        </oval-def:criteria>
      </oval-def:criteria>
    </oval-def:criteria>
    <oval-def:criteria comment="Windows Media Services 9.1 on Windows Server 2003 x86/x64" operator="AND">
      <oval-def:criteria comment="OS Check" operator="OR">
        <oval-def:extend_definition comment="Microsoft Windows Server 2003 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1870" />
        <oval-def:extend_definition comment="Microsoft Windows Server 2003 (x64) is installed" definition_ref="oval:org.mitre.oval:def:730" />
      </oval-def:criteria>
      <oval-def:extend_definition comment="Microsoft Media Services 9.1 is installed" definition_ref="oval:org.mitre.oval:def:28596" />
      <oval-def:criterion comment="wmsserver.dll for Windows Media Services 9.1 is installed." test_ref="oval:org.mitre.oval:tst:6184" />
      <oval-def:criterion comment="the version of wmsserver.dll is less than 9.1.1.5001" test_ref="oval:org.mitre.oval:tst:10306" />
    </oval-def:criteria>
    <oval-def:criteria comment="Windows Media Services 9" operator="AND">
      <oval-def:criteria comment="OS Check" operator="OR">
        <oval-def:extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
        <oval-def:extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
      </oval-def:criteria>
      <oval-def:extend_definition comment="Microsoft Media Services 9 is installed" definition_ref="oval:org.mitre.oval:def:5844" />
      <oval-def:criterion comment="Wmsserver.dll version is less than 9.5.6001.18281" test_ref="oval:org.mitre.oval:tst:10413" />
    </oval-def:criteria>
  </oval-def:criteria>
</oval-def:definition>
