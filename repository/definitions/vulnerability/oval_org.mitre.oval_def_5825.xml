<oval-def:definition xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:5825" version="3">
  <oval-def:metadata>
    <oval-def:title>Messaging Queue Service Remote Code Execution Vulnerability</oval-def:title>
    <oval-def:affected family="windows">
      <oval-def:platform>Microsoft Windows XP</oval-def:platform>
      <oval-def:platform>Microsoft Windows Server 2003</oval-def:platform>
    </oval-def:affected>
    <oval-def:reference ref_id="CVE-2008-3464" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3464" source="CVE" />
    <oval-def:description>afd.sys in the Ancillary Function Driver (AFD) component in Microsoft Windows XP SP2 and SP3 and Windows Server 2003 SP1 and SP2 does not properly validate input sent from user mode to the kernel, which allows local users to gain privileges via a crafted application, as demonstrated using crafted pointers and lengths that bypass intended ProbeForRead and ProbeForWrite restrictions, aka "AFD Kernel Overwrite Vulnerability."</oval-def:description>
    <oval-def:oval_repository>
      <oval-def:dates>
        <oval-def:submitted date="2008-10-14T14:00:00">
          <oval-def:contributor organization="Secure Elements, Inc.">Jeff Ito</oval-def:contributor>
        </oval-def:submitted>
        <oval-def:status_change date="2008-10-16T14:02:09.987-04:00">DRAFT</oval-def:status_change>
        <oval-def:status_change date="2008-11-03T04:00:20.631-05:00">INTERIM</oval-def:status_change>
        <oval-def:status_change date="2008-11-24T04:00:14.752-05:00">ACCEPTED</oval-def:status_change>
        <oval-def:modified comment="EDITED oval:org.mitre.oval:def:5825 - Added support for Windows Server 2003 SP1 &amp; SP2 for Itanium Edition" date="2011-10-17T14:43:00.381-04:00">
          <oval-def:contributor organization="SecPod Technologies">Prashanth A.</oval-def:contributor>
        </oval-def:modified>
        <oval-def:status_change date="2011-10-17T14:44:17.357-04:00">INTERIM</oval-def:status_change>
        <oval-def:status_change date="2011-11-07T04:01:02.959-05:00">ACCEPTED</oval-def:status_change>
      </oval-def:dates>
      <oval-def:status>ACCEPTED</oval-def:status>
      <oval-def:min_schema_version>5.4</oval-def:min_schema_version>
    </oval-def:oval_repository>
  </oval-def:metadata>
  <oval-def:criteria operator="OR">
    <oval-def:criteria comment="Check for vulnerable Windows XP SP2 and afd.sys version" operator="AND">
      <oval-def:extend_definition comment="Microsoft Windows XP SP2 or later is installed" definition_ref="oval:org.mitre.oval:def:521" />
      <oval-def:criterion comment="The version of afd.sys is less than 5.1.2600.3427." test_ref="oval:org.mitre.oval:tst:9248" />
    </oval-def:criteria>
    <oval-def:criteria comment="Check for vulnerable Windows XP SP3 and afd.sys version" operator="AND">
      <oval-def:extend_definition comment="Microsoft Windows XP (x86) SP3 is installed" definition_ref="oval:org.mitre.oval:def:5631" />
      <oval-def:criterion comment="The version of afd.sys is less than 5.1.2600.5657." test_ref="oval:org.mitre.oval:tst:9065" />
    </oval-def:criteria>
    <oval-def:criteria comment="Check for vulnerable Windows XP SP1(x64)/Windows Server 2003 SP1 (x86)/(x64)/(IA-64) and afd.sys version" operator="AND">
      <oval-def:criteria comment="Check for vulnerable Windows XP SP1(x64)/Windows Server 2003 SP1 (x86)/(x64)/(IA-64)" operator="OR">
        <oval-def:extend_definition comment="Microsoft Windows XP Professional x64 Edition SP1 is installed" definition_ref="oval:org.mitre.oval:def:720" />
        <oval-def:extend_definition comment="Microsoft Windows Server 2003 SP1 (x86) is installed" definition_ref="oval:org.mitre.oval:def:565" />
        <oval-def:extend_definition comment="Microsoft Windows Server 2003 (x64) is installed" definition_ref="oval:org.mitre.oval:def:730" />
        <oval-def:extend_definition comment="Microsoft Windows Server 2003 SP1 for Itanium is installed" definition_ref="oval:org.mitre.oval:def:1205" />
      </oval-def:criteria>
      <oval-def:criterion comment="The version of afd.sys is less than 5.2.3790.3192." test_ref="oval:org.mitre.oval:tst:9122" />
    </oval-def:criteria>
    <oval-def:criteria comment="Check for vulnerable Windows XP SP2(x64)/Windows Server 2003 SP2 (x86)/(x64)/(IA-64) and afd.sys version" operator="AND">
      <oval-def:criteria comment="Check for vulnerable Windows XP SP2(x64)/Windows Server 2003 SP2 (x86)/(x64)/(IA-64)" operator="OR">
        <oval-def:extend_definition comment="Microsoft Windows XP x64 Edition SP2 is installed" definition_ref="oval:org.mitre.oval:def:4193" />
        <oval-def:extend_definition comment="Microsoft Windows Server 2003 SP2 (x86) is installed" definition_ref="oval:org.mitre.oval:def:1935" />
        <oval-def:extend_definition comment="Microsoft Windows Server 2003 SP2 (x64) is installed" definition_ref="oval:org.mitre.oval:def:2161" />
        <oval-def:extend_definition comment="Microsoft Windows Server 2003 (ia64) SP2 is installed" definition_ref="oval:org.mitre.oval:def:1442" />
      </oval-def:criteria>
      <oval-def:criterion comment="The version of afd.sys is less than 5.2.3790.4355." test_ref="oval:org.mitre.oval:tst:9331" />
    </oval-def:criteria>
  </oval-def:criteria>
</oval-def:definition>
