<oval-def:definition xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:6253" version="8">
  <oval-def:metadata>
    <oval-def:title>Active Directory Memory Leak Vulnerability</oval-def:title>
    <oval-def:affected family="windows">
      <oval-def:platform>Microsoft Windows XP</oval-def:platform>
      <oval-def:platform>Microsoft Windows 2000</oval-def:platform>
      <oval-def:platform>Microsoft Windows Server 2003</oval-def:platform>
    </oval-def:affected>
    <oval-def:reference ref_id="CVE-2009-1139" ref_url="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1139" source="CVE" />
    <oval-def:description>Memory leak in the LDAP service in Active Directory on Microsoft Windows 2000 SP4 and Server 2003 SP2, and Active Directory Application Mode (ADAM) on Windows XP SP2 and SP3 and Server 2003 SP2, allows remote attackers to cause a denial of service (memory consumption and service outage) via (1) LDAP or (2) LDAPS requests with unspecified OID filters, aka "Active Directory Memory Leak Vulnerability."</oval-def:description>
    <oval-def:oval_repository>
      <oval-def:dates>
        <oval-def:submitted date="2009-06-09T14:00:00">
          <oval-def:contributor organization="Gideon Technologies, Inc.">Dragos Prisaca</oval-def:contributor>
        </oval-def:submitted>
        <oval-def:status_change date="2009-06-15T17:06:23.798-04:00">DRAFT</oval-def:status_change>
        <oval-def:status_change date="2009-07-06T04:00:49.150-04:00">INTERIM</oval-def:status_change>
        <oval-def:status_change date="2009-07-21T07:46:04.829-04:00">ACCEPTED</oval-def:status_change>
        <oval-def:modified comment="Added test for checking if system is used as AD" date="2009-09-05T12:00:00.035-04:00">
          <oval-def:contributor organization="DTCC">J. Daniel Brown</oval-def:contributor>
        </oval-def:modified>
        <oval-def:status_change date="2009-09-14T04:00:17.999-04:00">INTERIM</oval-def:status_change>
        <oval-def:status_change date="2009-10-05T04:00:05.918-04:00">ACCEPTED</oval-def:status_change>
        <oval-def:modified comment="EDITED oval:org.mitre.oval:obj:5285 - obj:5285 is pointing to windows\system32 directory. But, adamdsa.dll file by default will be in windows\ADAM directory" date="2011-07-14T10:24:00.833-04:00">
          <oval-def:contributor organization="SecPod Technologies">Sharath S</oval-def:contributor>
        </oval-def:modified>
        <oval-def:status_change date="2011-07-14T10:26:45.439-04:00">INTERIM</oval-def:status_change>
        <oval-def:status_change date="2011-08-01T04:00:56.852-04:00">ACCEPTED</oval-def:status_change>
        <oval-def:modified comment="EDITED oval:org.mitre.oval:def:6253 - modified vulnerabilities which check the version of file adamdsa.dll" date="2013-12-18T16:36:00.218-05:00">
          <oval-def:contributor organization="ALTX-SOFT">Maria Kedovskaya</oval-def:contributor>
        </oval-def:modified>
        <oval-def:status_change date="2013-12-18T16:44:41.050-05:00">INTERIM</oval-def:status_change>
        <oval-def:status_change date="2014-01-06T04:00:48.296-05:00">ACCEPTED</oval-def:status_change>
        <oval-def:modified comment="EDITED oval:org.mitre.oval:tst:89195 - bulletin MS14-016, for the month of Mar 2014." date="2014-03-18T14:40:00.553-04:00">
          <oval-def:contributor organization="SecPod Technologies">Pooja Shetty</oval-def:contributor>
        </oval-def:modified>
        <oval-def:status_change date="2014-03-18T14:42:04.096-04:00">INTERIM</oval-def:status_change>
        <oval-def:status_change date="2014-04-07T04:06:55.913-04:00">ACCEPTED</oval-def:status_change>
      </oval-def:dates>
      <oval-def:status>ACCEPTED</oval-def:status>
      <oval-def:min_schema_version>5.4</oval-def:min_schema_version>
    </oval-def:oval_repository>
  </oval-def:metadata>
  <oval-def:criteria operator="OR">
    <oval-def:criteria operator="AND">
      <oval-def:extend_definition comment="Microsoft Windows 2000 SP4 or later is installed" definition_ref="oval:org.mitre.oval:def:229" />
      <oval-def:criterion comment="NTDS Service is installed" test_ref="oval:org.mitre.oval:tst:42615" />
      <oval-def:criterion comment="Ntdsa.dll version is less than 5.0.2195.7292" test_ref="oval:org.mitre.oval:tst:10236" />
      <oval-def:criterion comment="the system is being used as AD - DomainRole is 4 or 5" test_ref="oval:org.mitre.oval:tst:10696" />
    </oval-def:criteria>
    <oval-def:criteria operator="AND">
      <oval-def:criteria operator="OR">
        <oval-def:extend_definition comment="Microsoft Windows Server 2003 SP2 (x86) is installed" definition_ref="oval:org.mitre.oval:def:1935" />
        <oval-def:extend_definition comment="Microsoft Windows Server 2003 SP2 (x64) is installed" definition_ref="oval:org.mitre.oval:def:2161" />
      </oval-def:criteria>
      <oval-def:criteria comment="Active Directory or ADAM" operator="OR">
        <oval-def:criteria operator="AND">
          <oval-def:criterion comment="NTDS Service is installed" test_ref="oval:org.mitre.oval:tst:42615" />
          <oval-def:criterion comment="the system is being used as AD - DomainRole is 4 or 5" test_ref="oval:org.mitre.oval:tst:10696" />
          <oval-def:criterion comment="ntdsa.dll version is less than 5.2.3790.4501" test_ref="oval:org.mitre.oval:tst:9685" />
        </oval-def:criteria>
        <oval-def:criteria operator="AND">
          <oval-def:criterion comment="Check if ADAM service is installed" test_ref="oval:org.mitre.oval:tst:89195" />
          <oval-def:criterion comment="adamdsa.dll version is less than 1.1.3790.4503" test_ref="oval:org.mitre.oval:tst:9714" />
        </oval-def:criteria>
      </oval-def:criteria>
    </oval-def:criteria>
    <oval-def:criteria operator="AND">
      <oval-def:criteria operator="OR">
        <oval-def:extend_definition comment="Microsoft Windows XP (x86) SP2 is installed" definition_ref="oval:org.mitre.oval:def:754" />
        <oval-def:extend_definition comment="Microsoft Windows XP (x86) SP3 is installed" definition_ref="oval:org.mitre.oval:def:5631" />
      </oval-def:criteria>
      <oval-def:criterion comment="Check if ADAM service is installed" test_ref="oval:org.mitre.oval:tst:89195" />
      <oval-def:criterion comment="adamdsa.dll version is less than 1.1.3790.4501" test_ref="oval:org.mitre.oval:tst:10192" />
    </oval-def:criteria>
    <oval-def:criteria operator="AND">
      <oval-def:extend_definition comment="Microsoft Windows XP x64 Edition SP2 is installed" definition_ref="oval:org.mitre.oval:def:4193" />
      <oval-def:criterion comment="Check if ADAM service is installed" test_ref="oval:org.mitre.oval:tst:89195" />
      <oval-def:criterion comment="adamdsa.dll version is less than 1.1.3790.4503" test_ref="oval:org.mitre.oval:tst:9714" />
    </oval-def:criteria>
  </oval-def:criteria>
</oval-def:definition>
